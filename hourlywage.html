<!DOCTYPE html>
<html lang="ja" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>時給競争力シミュレーター</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class'
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; }
        .card-transition { transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .bar-transition { transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1); }
    </style>
</head>
<body class="bg-slate-50 dark:bg-slate-900 text-slate-800 dark:text-slate-200 min-h-screen pb-20 transition-colors">

    <div class="sticky top-0 z-50 bg-white/95 dark:bg-slate-800/95 backdrop-blur-md border-b border-slate-200 dark:border-slate-700 shadow-sm transition-colors">
        <div class="max-w-7xl mx-auto px-4 py-3">
            <div class="flex flex-col lg:flex-row items-center justify-between gap-4">

                <div class="flex items-center gap-3 w-full lg:w-auto">
                    <div class="bg-indigo-900 dark:bg-indigo-600 text-white p-2 rounded-lg shrink-0">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path></svg>
                    </div>
                    <div>
                        <h1 class="text-xl font-black text-slate-800 dark:text-slate-100 leading-none">
                            時給競争力<span class="text-indigo-600 dark:text-indigo-400">シミュレーター</span>
                        </h1>
                        <p class="text-sm text-slate-500 dark:text-slate-400 font-bold">業界別・47都道府県対応</p>
                    </div>
                    <button id="darkModeToggle" onclick="toggleDarkMode()" class="ml-2 p-2 rounded-lg bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors" title="ダークモード切替">
                        <svg id="sunIcon" class="hidden dark:block w-5 h-5 text-yellow-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><circle cx="12" cy="12" r="5"/><path stroke-linecap="round" d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>
                        <svg id="moonIcon" class="block dark:hidden w-5 h-5 text-slate-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/></svg>
                    </button>
                </div>

                <div class="flex flex-col sm:flex-row items-center gap-3 w-full lg:w-auto bg-slate-100 dark:bg-slate-700 p-3 rounded-xl transition-colors">

                    <div class="flex flex-col w-full sm:w-auto">
                        <label class="text-sm font-bold text-slate-500 dark:text-slate-400 uppercase px-1 mb-1">ターゲット業界</label>
                        <select id="industrySelect" onchange="updateDashboard()" class="p-3 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-base font-bold text-slate-700 dark:text-slate-200 focus:outline-none focus:border-indigo-500">
                            <option value="hotel">宿泊業・飲食サービス業</option>
                            <option value="retail">卸売業・小売業</option>
                            <option value="service">生活関連サービス業・娯楽業</option>
                            <option value="dispatch">サービス業（派遣等）</option>
                        </select>
                    </div>

                    <div class="flex flex-col w-full sm:w-auto">
                        <label class="text-sm font-bold text-slate-500 dark:text-slate-400 uppercase px-1 mb-1">提案時給 (円)</label>
                        <div class="relative w-full sm:w-48">
                            <input type="number" id="globalWageInput" value="1150" step="10"
                                oninput="updateDashboard()"
                                class="w-full p-3 pl-4 rounded-lg border-2 border-indigo-200 dark:border-indigo-700 bg-white dark:bg-slate-800 font-black text-2xl text-center text-slate-800 dark:text-slate-100 focus:outline-none focus:border-indigo-600 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-indigo-900 shadow-sm transition-colors">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <main class="max-w-7xl mx-auto px-4 py-8">
        
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 p-6 mb-8 transition-colors">
            <h3 class="text-base font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest mb-4 border-b border-slate-100 dark:border-slate-700 pb-3">判定基準の解説</h3>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="flex items-start gap-4">
                    <div class="w-4 h-4 rounded-full bg-emerald-500 mt-1 shrink-0"></div>
                    <div>
                        <p class="text-base font-black text-emerald-700 dark:text-emerald-400">安全</p>
                        <p class="text-sm text-slate-500 dark:text-slate-400 leading-relaxed">市場相場より10%以上高く、求職者に「稼げる」と認識され、十分な応募が見込める状態。</p>
                    </div>
                </div>
                <div class="flex items-start gap-4">
                    <div class="w-4 h-4 rounded-full bg-amber-400 mt-1 shrink-0"></div>
                    <div>
                        <p class="text-base font-black text-amber-600 dark:text-amber-400">注意</p>
                        <p class="text-sm text-slate-500 dark:text-slate-400 leading-relaxed">市場相場と同程度。競合他社と条件が並んでおり、立地やブランド力がないと埋もれる状態。</p>
                    </div>
                </div>
                <div class="flex items-start gap-4">
                    <div class="w-4 h-4 rounded-full bg-rose-500 mt-1 shrink-0"></div>
                    <div>
                        <p class="text-base font-black text-rose-600 dark:text-rose-400">危険</p>
                        <p class="text-sm text-slate-500 dark:text-slate-400 leading-relaxed">市場相場を下回っている。最低賃金以上だが、他社より条件が悪いため応募がほぼ来ない状態。</p>
                    </div>
                </div>
                <div class="flex items-start gap-4">
                    <div class="w-4 h-4 rounded-full bg-slate-800 dark:bg-slate-500 mt-1 shrink-0"></div>
                    <div>
                        <p class="text-base font-black text-slate-800 dark:text-slate-300">違反</p>
                        <p class="text-sm text-slate-500 dark:text-slate-400 leading-relaxed">最低賃金を下回っている状態。法律違反となり、求人媒体への掲載も不可。</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="dashboardContainer" class="space-y-12"></div>

        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 p-6 mt-12 transition-colors">
            <h3 class="text-base font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest mb-4 border-b border-slate-100 dark:border-slate-700 pb-3">データソース・計算ロジック</h3>

            <div class="space-y-6 text-sm text-slate-600 dark:text-slate-400">
                <div>
                    <h4 class="font-bold text-slate-700 dark:text-slate-300 mb-2">市場相場データ（全業界）</h4>
                    <p class="text-xs mb-2"><strong>2019年の実データを最低賃金上昇率で補正した推定値</strong>を使用しています。</p>
                    <ul class="list-disc list-inside space-y-1 ml-2">
                        <li><strong>出典:</strong> e-Stat 賃金構造基本統計調査（厚生労働省）</li>
                        <li><strong>統計表ID:</strong> 0003084963</li>
                        <li><strong>対象:</strong> 短時間労働者 / 1時間当たり所定内給与額 / 都道府県別</li>
                        <li><strong>基準年:</strong> 2019年（令和元年）</li>
                    </ul>
                    <div class="mt-3 bg-slate-50 dark:bg-slate-700/50 p-3 rounded-lg text-xs">
                        <p class="font-bold mb-1">対象業種（e-Stat産業分類）:</p>
                        <ul class="list-disc list-inside ml-2 space-y-0.5">
                            <li>宿泊業・飲食サービス業（産業コード83）</li>
                            <li>卸売業・小売業（産業コード52）</li>
                            <li>生活関連サービス業・娯楽業（産業コード87）</li>
                            <li>サービス業（他に分類されないもの）（産業コード101）</li>
                        </ul>
                    </div>
                </div>

                <div>
                    <h4 class="font-bold text-slate-700 dark:text-slate-300 mb-2">2024年推定値の計算ロジック</h4>
                    <div class="bg-slate-50 dark:bg-slate-700/50 p-3 rounded-lg font-mono text-xs">
                        2024年推定時給 = 2019年実績 × (2024年最低賃金 ÷ 2019年最低賃金)
                    </div>
                    <p class="mt-2 text-xs">最低賃金の上昇率を用いて、2019年の実データを2024年水準に補正しています。</p>
                    <div class="mt-3 bg-amber-50 dark:bg-amber-900/20 border-l-4 border-amber-400 p-3 text-xs">
                        <p class="font-bold text-amber-800 dark:text-amber-300 mb-1">⚠ 注意</p>
                        <p class="text-amber-700 dark:text-amber-400">2020年以降、短時間労働者の産業×都道府県クロス集計データがe-Statで公開されていないため、2019年の実データを最低賃金上昇率で補正した推定値を使用しています。実際の募集条件とは異なる場合がありますので、参考値としてご活用ください。</p>
                    </div>
                </div>

                <div>
                    <h4 class="font-bold text-slate-700 dark:text-slate-300 mb-2">最低賃金データ</h4>
                    <ul class="list-disc list-inside space-y-1 ml-2">
                        <li><strong>2024年度:</strong> 各都道府県の地域別最低賃金（2024年10月発効）</li>
                        <li><strong>出典:</strong> 厚生労働省 地域別最低賃金の全国一覧</li>
                    </ul>
                </div>

                <div>
                    <h4 class="font-bold text-slate-700 dark:text-slate-300 mb-2">注意事項</h4>
                    <ul class="list-disc list-inside space-y-1 ml-2 text-xs text-slate-500 dark:text-slate-500">
                        <li>市場相場は統計データに基づく推定値であり、実際の募集条件とは異なる場合があります</li>
                        <li>2019年以降の賃金構造基本統計調査では、短時間労働者の産業×都道府県クロス集計が未整備のため、2019年データを基に補正しています</li>
                        <li>最低賃金は毎年10月頃に改定されます</li>
                    </ul>
                </div>
            </div>
        </div>

    </main>

    <script>
        /*
         * ============================================================
         * 最低賃金データ取得ロードマップ
         * ============================================================
         *
         * 【現状】
         * - 現在のデータは2024年度の最低賃金をハードコーディング
         * - 2025年度は全都道府県で1,000円超え（全国加重平均1,121円）
         *
         * 【オープンデータソース】
         *
         * 1. e-Stat API（政府統計の総合窓口）★推奨
         *    URL: https://www.e-stat.go.jp/api/
         *    - 無料のユーザー登録でAPIキー取得可能
         *    - JSON/XML/CSV形式でデータ取得可能
         *    - 統計表ID検索で「最低賃金」を検索し、該当データを特定
         *    - 例: https://api.e-stat.go.jp/rest/3.0/app/json/getStatsData?appId=YOUR_KEY&statsDataId=XXXX
         *
         * 2. 厚生労働省 最低賃金特設サイト
         *    URL: https://saiteichingin.mhlw.go.jp/
         *    - 都道府県別の最新データを掲載
         *    - APIは提供されていないため、スクレイピングが必要
         *    - 「地域別最低賃金全国一覧」ページからデータ取得可能
         *
         * 3. 労働政策研究・研修機構（JILPT）
         *    URL: https://www.jil.go.jp/kokunai/statistics/timeseries/html/g0403.html
         *    - 時系列データをExcel形式で提供
         *    - 過去データの取得に適している
         *
         * 【実装ステップ】
         *
         * Phase 1: 手動更新の効率化
         *   - 現在のハードコーディングを外部JSONファイルに分離
         *   - データ更新日時を表示する機能を追加
         *
         * Phase 2: 自動取得の実装（推奨: e-Stat API）
         *   - e-Statユーザー登録・APIキー取得
         *   - 最低賃金の統計表IDを特定
         *   - fetch()でJSONデータを取得するコードを実装
         *   - LocalStorageにキャッシュし、定期的に更新
         *
         * Phase 3: バックエンド連携（オプション）
         *   - CORSの問題を回避するため、プロキシサーバーを経由
         *   - または、GitHub Actionsで定期的にデータを更新しJSONファイルを生成
         *
         * 【注意事項】
         * - 最低賃金は毎年10月頃に改定される
         * - 発効日は都道府県により異なる（10月1日〜1月初旬）
         * - e-Stat APIの利用規約を確認すること
         *
         * ============================================================
         */

        // 業界別実データ（e-Stat 賃金構造基本統計調査 2019年）
        // 2024年推定値 = 2019年実績 × (2024年最低賃金 / 2019年最低賃金)

        // 宿泊業，飲食サービス業（産業コード: 83）
        const hotelWage2019 = {
            "北海道": 966, "青森県": 877, "岩手県": 891, "宮城県": 934,
            "秋田県": 940, "山形県": 904, "福島県": 943, "茨城県": 997,
            "栃木県": 967, "群馬県": 991, "埼玉県": 1028, "千葉県": 1060,
            "東京都": 1154, "神奈川県": 1119, "新潟県": 946, "富山県": 1007,
            "石川県": 996, "福井県": 979, "山梨県": 1060, "長野県": 981,
            "岐阜県": 996, "静岡県": 1036, "愛知県": 1050, "三重県": 984,
            "滋賀県": 966, "京都府": 1048, "大阪府": 1065, "兵庫県": 1019,
            "奈良県": 966, "和歌山県": 941, "鳥取県": 904, "島根県": 928,
            "岡山県": 951, "広島県": 1012, "山口県": 953, "徳島県": 942,
            "香川県": 950, "愛媛県": 892, "高知県": 916, "福岡県": 952,
            "佐賀県": 910, "長崎県": 944, "熊本県": 921, "大分県": 939,
            "宮崎県": 900, "鹿児島県": 908, "沖縄県": 918
        };

        // 卸売業，小売業（産業コード: 52）
        const retailWage2019 = {
            "北海道": 974, "青森県": 909, "岩手県": 979, "宮城県": 968,
            "秋田県": 922, "山形県": 942, "福島県": 899, "茨城県": 974,
            "栃木県": 997, "群馬県": 1005, "埼玉県": 1088, "千葉県": 1079,
            "東京都": 1210, "神奈川県": 1169, "新潟県": 995, "富山県": 1080,
            "石川県": 999, "福井県": 1086, "山梨県": 1000, "長野県": 1055,
            "岐阜県": 998, "静岡県": 1024, "愛知県": 1067, "三重県": 1031,
            "滋賀県": 1002, "京都府": 1052, "大阪府": 1113, "兵庫県": 1040,
            "奈良県": 1005, "和歌山県": 973, "鳥取県": 959, "島根県": 1038,
            "岡山県": 1012, "広島県": 1049, "山口県": 916, "徳島県": 964,
            "香川県": 981, "愛媛県": 959, "高知県": 947, "福岡県": 986,
            "佐賀県": 922, "長崎県": 901, "熊本県": 909, "大分県": 890,
            "宮崎県": 945, "鹿児島県": 893, "沖縄県": 967
        };

        // 生活関連サービス業，娯楽業（産業コード: 87）
        const serviceWage2019 = {
            "北海道": 1023, "青森県": 985, "岩手県": 915, "宮城県": 1095,
            "秋田県": 956, "山形県": 1069, "福島県": 1070, "茨城県": 1084,
            "栃木県": 1000, "群馬県": 1085, "埼玉県": 1105, "千葉県": 1196,
            "東京都": 1305, "神奈川県": 1194, "新潟県": 998, "富山県": 1055,
            "石川県": 1068, "福井県": 1013, "山梨県": 1003, "長野県": 1021,
            "岐阜県": 1109, "静岡県": 1055, "愛知県": 1143, "三重県": 1088,
            "滋賀県": 1020, "京都府": 1114, "大阪府": 1128, "兵庫県": 1066,
            "奈良県": 1167, "和歌山県": 1297, "鳥取県": 1136, "島根県": 948,
            "岡山県": 1096, "広島県": 1091, "山口県": 974, "徳島県": 1028,
            "香川県": 1072, "愛媛県": 1071, "高知県": 1073, "福岡県": 1045,
            "佐賀県": 1024, "長崎県": 1013, "熊本県": 1013, "大分県": 1025,
            "宮崎県": 1010, "鹿児島県": 1005, "沖縄県": 952
        };

        // サービス業（他に分類されないもの）（産業コード: 101）- 派遣業含む
        const dispatchWage2019 = {
            "北海道": 988, "青森県": 894, "岩手県": 963, "宮城県": 994,
            "秋田県": 860, "山形県": 943, "福島県": 998, "茨城県": 1097,
            "栃木県": 1087, "群馬県": 1052, "埼玉県": 1051, "千葉県": 1099,
            "東京都": 1355, "神奈川県": 1222, "新潟県": 987, "富山県": 969,
            "石川県": 1007, "福井県": 1025, "山梨県": 1019, "長野県": 997,
            "岐阜県": 1038, "静岡県": 1059, "愛知県": 1098, "三重県": 1053,
            "滋賀県": 1093, "京都府": 1091, "大阪府": 1110, "兵庫県": 1057,
            "奈良県": 1015, "和歌山県": 1009, "鳥取県": 1027, "島根県": 1035,
            "岡山県": 1041, "広島県": 1057, "山口県": 968, "徳島県": 973,
            "香川県": 1007, "愛媛県": 980, "高知県": 925, "福岡県": 1156,
            "佐賀県": 947, "長崎県": 976, "熊本県": 948, "大分県": 920,
            "宮崎県": 952, "鹿児島県": 1117, "沖縄県": 961
        };

        // 2019年の最低賃金（補正計算用）
        const minWage2019 = {
            "北海道": 861, "青森県": 790, "岩手県": 790, "宮城県": 824,
            "秋田県": 790, "山形県": 790, "福島県": 798, "茨城県": 849,
            "栃木県": 853, "群馬県": 835, "埼玉県": 926, "千葉県": 923,
            "東京都": 1013, "神奈川県": 1011, "新潟県": 830, "富山県": 848,
            "石川県": 832, "福井県": 829, "山梨県": 837, "長野県": 848,
            "岐阜県": 851, "静岡県": 885, "愛知県": 926, "三重県": 873,
            "滋賀県": 866, "京都府": 909, "大阪府": 964, "兵庫県": 899,
            "奈良県": 837, "和歌山県": 830, "鳥取県": 790, "島根県": 790,
            "岡山県": 833, "広島県": 871, "山口県": 829, "徳島県": 793,
            "香川県": 818, "愛媛県": 790, "高知県": 790, "福岡県": 841,
            "佐賀県": 790, "長崎県": 790, "熊本県": 790, "大分県": 790,
            "宮崎県": 790, "鹿児島県": 790, "沖縄県": 790
        };

        // 47都道府県データ（2024年度最低賃金）
        const regions = [
            {
                name: "北海道・東北",
                prefs: [
                    { name: "北海道", min: 1010 }, { name: "青森県", min: 953 },
                    { name: "岩手県", min: 952 }, { name: "宮城県", min: 973 },
                    { name: "秋田県", min: 951 }, { name: "山形県", min: 955 },
                    { name: "福島県", min: 955 }
                ]
            },
            {
                name: "関東",
                prefs: [
                    { name: "茨城県", min: 1005 }, { name: "栃木県", min: 1004 },
                    { name: "群馬県", min: 985 }, { name: "埼玉県", min: 1078 },
                    { name: "千葉県", min: 1076 }, { name: "東京都", min: 1163 },
                    { name: "神奈川県", min: 1162 }
                ]
            },
            {
                name: "中部・北陸",
                prefs: [
                    { name: "新潟県", min: 985 }, { name: "富山県", min: 998 },
                    { name: "石川県", min: 984 }, { name: "福井県", min: 984 },
                    { name: "山梨県", min: 988 }, { name: "長野県", min: 998 },
                    { name: "岐阜県", min: 1001 }, { name: "静岡県", min: 1034 },
                    { name: "愛知県", min: 1077 }
                ]
            },
            {
                name: "近畿",
                prefs: [
                    { name: "三重県", min: 1023 }, { name: "滋賀県", min: 1017 },
                    { name: "京都府", min: 1058 }, { name: "大阪府", min: 1114 },
                    { name: "兵庫県", min: 1052 }, { name: "奈良県", min: 986 },
                    { name: "和歌山県", min: 980 }
                ]
            },
            {
                name: "中国・四国",
                prefs: [
                    { name: "鳥取県", min: 950 }, { name: "島根県", min: 963 },
                    { name: "岡山県", min: 982 }, { name: "広島県", min: 1020 },
                    { name: "山口県", min: 979 }, { name: "徳島県", min: 980 },
                    { name: "香川県", min: 970 }, { name: "愛媛県", min: 956 },
                    { name: "高知県", min: 952 }
                ]
            },
            {
                name: "九州・沖縄",
                prefs: [
                    { name: "福岡県", min: 992 }, { name: "佐賀県", min: 956 },
                    { name: "長崎県", min: 953 }, { name: "熊本県", min: 952 },
                    { name: "大分県", min: 954 }, { name: "宮崎県", min: 952 },
                    { name: "鹿児島県", min: 953 }, { name: "沖縄県", min: 952 }
                ]
            }
        ];

        // 業界別2019年データのマッピング
        const industryData = {
            hotel: hotelWage2019,
            retail: retailWage2019,
            service: serviceWage2019,
            dispatch: dispatchWage2019
        };

        // 2024年推定時給を計算（2019年実績 × 最低賃金上昇率）
        function getEstimatedWage2024(prefName, min2024, industryType) {
            const wage2019Data = industryData[industryType];
            if (!wage2019Data) return null;
            const wage2019 = wage2019Data[prefName];
            const min2019 = minWage2019[prefName];
            if (!wage2019 || !min2019) return null;
            return Math.round(wage2019 * (min2024 / min2019));
        }

        // 初期描画
        function renderDashboard() {
            const container = document.getElementById('dashboardContainer');
            container.innerHTML = '';

            regions.forEach((region, rIndex) => {
                // セクション作成
                const section = document.createElement('section');
                
                // エリアタイトル
                const title = document.createElement('h2');
                title.className = "text-2xl font-black text-slate-700 dark:text-slate-200 mb-5 px-3 border-l-4 border-slate-300 dark:border-slate-600 flex items-center";
                title.innerHTML = `${region.name}`;
                section.appendChild(title);

                // グリッド作成
                const grid = document.createElement('div');
                grid.className = "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5";

                region.prefs.forEach((pref, pIndex) => {
                    const id = `pref-${rIndex}-${pIndex}`;
                    const card = document.createElement('div');
                    card.id = `card-${id}`;
                    // 初期クラス
                    card.className = "card-transition bg-white dark:bg-slate-800 rounded-xl p-5 border dark:border-slate-700 shadow-sm relative overflow-hidden group";

                    card.innerHTML = `
                        <div class="flex justify-between items-start mb-4 relative z-10">
                            <h3 class="font-bold text-xl text-slate-700 dark:text-slate-200">${pref.name}</h3>
                            <span id="badge-${id}" class="text-sm font-bold px-3 py-1.5 rounded bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400">--</span>
                        </div>

                        <div class="grid grid-cols-2 gap-3 mb-4 relative z-10">
                            <div class="bg-slate-50 dark:bg-slate-700/50 p-3 rounded-lg border border-slate-100 dark:border-slate-600">
                                <span class="block text-sm text-slate-400 font-bold">法的下限</span>
                                <span class="block text-lg font-bold text-slate-600 dark:text-slate-300">${pref.min}円</span>
                            </div>
                            <div class="bg-indigo-50 dark:bg-indigo-900/30 p-3 rounded-lg border border-indigo-100 dark:border-indigo-800">
                                <span class="block text-sm text-indigo-400 font-bold">市場相場</span>
                                <span id="avg-${id}" class="block text-lg font-bold text-indigo-700 dark:text-indigo-400">--円</span>
                            </div>
                        </div>

                        <div class="relative z-10">
                            <div class="flex justify-between items-end mb-2">
                                <span class="text-sm font-bold text-slate-400">達成率</span>
                                <span id="diff-${id}" class="text-base font-black text-slate-400">--</span>
                            </div>

                            <div class="h-3 w-full bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden">
                                <div id="bar-${id}" class="bar-transition h-full w-0 bg-slate-300"></div>
                            </div>
                        </div>

                    `;
                    
                    grid.appendChild(card);
                    
                    pref.dom = {
                        card: card,
                        badge: card.querySelector(`#badge-${id}`),
                        avgText: card.querySelector(`#avg-${id}`),
                        diff: card.querySelector(`#diff-${id}`),
                        bar: card.querySelector(`#bar-${id}`)
                    };
                });

                section.appendChild(grid);
                container.appendChild(section);
            });

            updateDashboard();
        }

        // 更新ロジック
        function updateDashboard() {
            const inputVal = parseInt(document.getElementById('globalWageInput').value) || 0;
            const industryValue = document.getElementById('industrySelect').value;

            regions.forEach(region => {
                region.prefs.forEach(pref => {
                    const { name, min, dom } = pref;

                    // 相場（Avg）を計算
                    // 全業界: e-Stat実データ（2019年→2024年補正）
                    const avg = getEstimatedWage2024(name, min, industryValue);
                    
                    let status = "安全";
                    let theme = "emerald";
                    let diffText = "";

                    // Logic
                    if (inputVal < min) {
                        status = "違反";
                        theme = "slate";
                    } else {

                        if (inputVal < avg) {
                            status = "危険";
                            theme = "rose";
                            const gap = avg - inputVal;
                            diffText = `相場まで -${gap}円`;
                        } else if (inputVal < avg * 1.1) {
                            status = "注意";
                            theme = "amber";
                            diffText = "競合と横並び";
                        } else {
                            status = "安全";
                            theme = "emerald";
                            const over = inputVal - avg;
                            diffText = `相場より +${over}円`;
                        }
                    }

                    // --- DOM Updates ---
                    
                    // 1. Avg Text Update
                    dom.avgText.textContent = `${avg}円`;

                    // 2. Card Border & Styles
                    if (theme === 'slate') {
                        dom.card.className = `card-transition bg-slate-100 dark:bg-slate-800 rounded-xl p-5 border-b-4 border-slate-600 dark:border-slate-500 shadow-sm relative overflow-hidden group`;
                        dom.badge.className = "text-sm font-bold px-3 py-1.5 rounded bg-slate-700 dark:bg-slate-600 text-white";
                        dom.badge.textContent = "違反";
                        const gap = min - inputVal;
                        dom.diff.textContent = `最低賃金まで +${gap}円`;
                        dom.diff.className = "text-base font-black text-slate-600 dark:text-slate-300";
                        dom.bar.style.width = "0%";
                        dom.bar.className = "bar-transition h-full bg-slate-400";
                    } else {
                        const colorMap = {
                            rose: { border: 'border-rose-500', text: 'text-rose-600 dark:text-rose-400', bar: 'bg-rose-500', badge: 'bg-rose-100 dark:bg-rose-900/50 text-rose-700 dark:text-rose-300' },
                            amber: { border: 'border-amber-400', text: 'text-amber-600 dark:text-amber-400', bar: 'bg-amber-400', badge: 'bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-300' },
                            emerald: { border: 'border-emerald-500', text: 'text-emerald-600 dark:text-emerald-400', bar: 'bg-emerald-500', badge: 'bg-emerald-100 dark:bg-emerald-900/50 text-emerald-700 dark:text-emerald-300' }
                        };
                        const c = colorMap[theme];

                        dom.card.className = `card-transition bg-white dark:bg-slate-800 rounded-xl p-5 border-b-4 shadow-sm relative overflow-hidden group ${c.border}`;

                        dom.badge.className = `text-sm font-bold px-3 py-1.5 rounded ${c.badge}`;
                        dom.badge.textContent = status;

                        dom.diff.className = `text-base font-black ${c.text}`;
                        dom.diff.textContent = diffText;

                        // Bar Calculation (Scale: 0% = Min Wage, 100% = Avg * 1.2)
                        const rangeMin = min;
                        const rangeMax = avg * 1.2;
                        const pct = Math.max(0, Math.min(100, ((inputVal - rangeMin) / (rangeMax - rangeMin)) * 100));

                        dom.bar.className = `bar-transition h-full ${c.bar}`;
                        dom.bar.style.width = `${pct}%`;
                    }
                });
            });
        }

        function toggleDarkMode() {
            const html = document.documentElement;
            if (html.classList.contains('dark')) {
                html.classList.remove('dark');
                localStorage.setItem('darkMode', 'light');
            } else {
                html.classList.add('dark');
                localStorage.setItem('darkMode', 'dark');
            }
        }

        function initDarkMode() {
            const saved = localStorage.getItem('darkMode');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (saved === 'dark' || (!saved && prefersDark)) {
                document.documentElement.classList.add('dark');
            }
        }

        initDarkMode();
        window.addEventListener('DOMContentLoaded', renderDashboard);
    </script>
</body>
</html>
